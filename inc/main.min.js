var app=new Vue({el:".lightning",data:{currentFunding:0,pastFundingTargets:[],currentFundingTargets:[],futureFundingTargets:[]},methods:{fundingPercentage:function(e){return this.percentage=this.currentFunding/e*100,this.percentage>100&&(this.percentage=100),this.percentage},addNewFundingTarget:function(){app.pastFundingTargets.push(app.currentFundingTargets.shift()),app.currentFundingTargets.push(app.futureFundingTargets.shift())},getPercentage:function(){return this.currentFundingTargets[0].percentage+"%"},setActive:function(){document.querySelector(".progress").classList.add("active")},resetActive:function(){document.querySelector(".progress").classList.remove("active")},listenForFunding:function(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){console.log("RESPONSE: "+e.responseText);var n=JSON.parse(e.responseText);n.donations&&n.donations!=app.currentFunding&&(app.currentFunding=n.donations)}};var n=window.location.href+"inc/lightningTip.php";console.log("requestUrl: "+n),e.open("POST",n,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send("Action=getdonations")}},watch:{currentFunding:function(){app.setActive(),app.currentFundingTargets[0].percentage=app.fundingPercentage(app.currentFundingTargets[0].fundingTarget),app.currentFunding>=app.currentFundingTargets[0].fundingTarget&&setTimeout(function(){app.addNewFundingTarget(),setTimeout(function(){app.currentFundingTargets[0].percentage=app.fundingPercentage(app.currentFundingTargets[0].fundingTarget),app.setActive(),setTimeout(function(){app.resetActive()},2e3)},100)},2e3),setTimeout(function(){app.resetActive()},1800)}},mounted:function(){this.$nextTick(function(){window.setInterval(()=>{app.listenForFunding()},2e3)})},created:function(){console.log("init"),loadJSON(function(e){var n=JSON.parse(e);app.currentFundingTargets.push(n.shift()),app.futureFundingTargets=n},document.documentElement.lang)}});function loadJSON(e,n){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET","./inc/"+n+"_fundingTargets.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}